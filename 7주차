#include <stdio.h>
#include <string.h>

#define MAX_PRODUCTS 5

typedef struct {
    int id;
    char name[20];
    int price;
    int stock;
    int sold;
    int total_sales;
} Product;

Product products[MAX_PRODUCTS];
int product_count = 0;


int find_product(int id) {
    for(int i = 0; i < product_count; i++)
        if(products[i].id == id) return i;
    return -1;
}

void input_product() {
    int id, input_stock, input_price, idx;
    char name[20];

    if(product_count == MAX_PRODUCTS) {
        printf("상품 최대 갯수 초과!\n");
        return;
    }

    printf("상품ID : ");
    scanf("%d", &id);

    idx = find_product(id);

    printf("상품명 : ");
    scanf("%s", name);
    printf("입고량 : ");
    scanf("%d", &input_stock);
    printf("판매가격 : ");
    scanf("%d", &input_price);

    if(idx == -1 && product_count < MAX_PRODUCTS) {
        // 신규
        products[product_count].id = id;
        strcpy(products[product_count].name, name);
        products[product_count].price = input_price;
        products[product_count].stock = input_stock;
        products[product_count].sold = 0;
        products[product_count].total_sales = 0;
        product_count++;
    } else if(idx != -1) {

        strcpy(products[idx].name, name);
        products[idx].stock += input_stock;
        products[idx].price = input_price;
    }
}

void sell_product() {
    int id, amount, idx;
    printf("상품ID : ");
    scanf("%d", &id);

    idx = find_product(id);
    if(idx == -1) {
        printf("없는 상품입니다!\n");
        return;
    }
    printf("판매량 : ");
    scanf("%d", &amount);
    if(products[idx].stock < amount) {
        printf("재고 부족!\n");
        return;
    }
    products[idx].stock -= amount;
    products[idx].sold += amount;
    products[idx].total_sales += amount * products[idx].price;
}

void show_product() {
    int id, idx;
    printf("상품ID : ");
    scanf("%d", &id);

    idx = find_product(id);
    if(idx == -1) {
        printf("없는 상품입니다!\n");
        return;
    }

    printf("ID:%d | 이름:%s | 가격:%d | 재고:%d | 판매:%d | 총판매금액:%d\n",
        products[idx].id, products[idx].name, products[idx].price,
        products[idx].stock, products[idx].sold, products[idx].total_sales);
}

void show_all() {
    printf("전체 상품 현황:\n");
    for(int i = 0; i < product_count; i++) {
        printf("ID:%d | 이름:%s | 가격:%d | 재고:%d | 판매:%d | 총판매금액:%d\n",
            products[i].id, products[i].name, products[i].price,
            products[i].stock, products[i].sold, products[i].total_sales);
    }
}

int main() {
    int menu;
    while(1) {
        printf("\n원하는 메뉴를 선택하세요.(1. 입고, 2. 판매, 3. 개별현황, 4. 전체현황, 5. 종료)\n");
        scanf("%d", &menu);
        if(menu == 1) input_product();
        else if(menu == 2) sell_product();
        else if(menu == 3) show_product();
        else if(menu == 4) show_all();
        else if(menu == 5) break;
        else printf("잘못된 메뉴입니다!\n");
    }
    return 0;
}
